<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<title>Yeraltƒ± ≈ûehri</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<script src="https://unpkg.com/@supabase/supabase-js@2"></script>

<style>
body{background:#0b0b0b;color:#fff;font-family:Arial,sans-serif;padding:20px}
h1{text-align:center}
button{width:100%;padding:14px;margin:8px 0;background:#1a1a1a;color:#fff;border:none;border-radius:8px;font-size:16px}
button:hover{background:#333}
.box{background:#151515;padding:15px;border-radius:8px;margin-bottom:15px}
.hidden{display:none}
.success{color:#4caf50}
.error{color:#f44336}
small{color:#aaa}
</style>
</head>

<body>

<h1>üî• Yeraltƒ± ≈ûehri</h1>

<div id="playerInfo" class="box">Y√ºkleniyor...</div>

<button onclick="openNightlife()">üåÉ Gece Hayatƒ±</button>
<button onclick="hospital()">üè• Hastane</button>

<div id="nightlife" class="box hidden"></div>
<div id="result" class="box hidden"></div>

<script>
/* ================= SUPABASE ================= */
const sb = supabase.createClient(
  "https://hwhscuyudwphnsipibpy.supabase.co",
  "sb_publishable_dItLcV8z83CvDWuR8nTabA_ImTHGETu"
);
const TELEGRAM_ID = "162154220";

/* ================= GENEL EV Kƒ∞≈ûƒ∞LER ================= */
const brothelPeople = [
  // üë© Kadƒ±nlar (20)
  {id:301,name:"Mia Khalite",price:40,effect:"+12 Enerji | Risk %5"},
  {id:302,name:"Lana Rhoadsen",price:42,effect:"+13 Enerji | Risk %6"},
  {id:303,name:"Abella Deyne",price:45,effect:"+14 Enerji | Risk %6"},
  {id:304,name:"Riley Reidon",price:44,effect:"+13 Enerji | Risk %5"},
  {id:305,name:"Angela Whytey",price:46,effect:"+14 Enerji | Risk %7"},
  {id:306,name:"Sasha Greylin",price:48,effect:"+15 Enerji | Risk %7"},
  {id:307,name:"Megan Rainy",price:41,effect:"+12 Enerji | Risk %5"},
  {id:308,name:"Jenna Foxer",price:43,effect:"+13 Enerji | Risk %6"},
  {id:309,name:"Brandi Lovex",price:47,effect:"+14 Enerji | Risk %7"},
  {id:310,name:"Eva Elfiee",price:50,effect:"+16 Enerji | Risk %8"},
  {id:311,name:"Nina Northy",price:44,effect:"+13 Enerji | Risk %6"},
  {id:312,name:"Lexi Lorex",price:46,effect:"+14 Enerji | Risk %7"},
  {id:313,name:"Mila Azulay",price:49,effect:"+15 Enerji | Risk %8"},
  {id:314,name:"Emily Willisn",price:45,effect:"+14 Enerji | Risk %6"},
  {id:315,name:"Violet Myerss",price:48,effect:"+15 Enerji | Risk %7"},
  {id:316,name:"Elsa Jeannex",price:47,effect:"+14 Enerji | Risk %7"},
  {id:317,name:"Adriana Chekx",price:50,effect:"+16 Enerji | Risk %8"},
  {id:318,name:"Kendra Lusty",price:52,effect:"+17 Enerji | Risk %9"},
  {id:319,name:"Sky Brii",price:46,effect:"+14 Enerji | Risk %6"},
  {id:320,name:"Aria Luxen",price:49,effect:"+15 Enerji | Risk %8"},

  // üë® Erkekler (10)
  {id:321,name:"Johnny Sinsy",price:35,effect:"+10 Enerji | Risk %4"},
  {id:322,name:"Manuel Ferron",price:36,effect:"+10 Enerji | Risk %4"},
  {id:323,name:"Rocco Steell",price:38,effect:"+11 Enerji | Risk %5"},
  {id:324,name:"Jordi El Ninox",price:37,effect:"+10 Enerji | Risk %4"},
  {id:325,name:"Nacho Vidalx",price:39,effect:"+11 Enerji | Risk %5"},
  {id:326,name:"Markus Dupreex",price:36,effect:"+10 Enerji | Risk %4"},
  {id:327,name:"Alex Legendz",price:40,effect:"+12 Enerji | Risk %5"},
  {id:328,name:"Tommy Gunnr",price:38,effect:"+11 Enerji | Risk %5"},
  {id:329,name:"Ramon Nomarx",price:37,effect:"+10 Enerji | Risk %4"},
  {id:330,name:"James Deenx",price:39,effect:"+11 Enerji | Risk %5"},

  // üëØ ƒ∞kizler (5 √ßift)
  {id:331,name:"Luna & Lina Twinz",price:80,effect:"+22 Enerji | Risk %12"},
  {id:332,name:"Nora & Nera Twinz",price:78,effect:"+21 Enerji | Risk %11"},
  {id:333,name:"Mila & Mina Twinz",price:82,effect:"+23 Enerji | Risk %13"},
  {id:334,name:"Sara & Sera Twinz",price:79,effect:"+21 Enerji | Risk %11"},
  {id:335,name:"Vera & Vira Twinz",price:85,effect:"+24 Enerji | Risk %14"}
];

/* ================= UI ================= */
function showBox(id){
  document.querySelectorAll(".box").forEach(b=>b.classList.add("hidden"));
  document.getElementById(id).classList.remove("hidden");
}
function showResult(msg){
  showBox("result");
  document.getElementById("result").innerHTML = `<span class="success">${msg}</span>`;
}

/* ================= PLAYER ================= */
async function loadPlayer(){
  const { data } = await sb.from("players")
    .select("*")
    .eq("telegram_id", TELEGRAM_ID)
    .single();
  if(!data) return;
  document.getElementById("playerInfo").innerHTML=`
    <b>Enerji:</b> ${data.energy} | <b>YTon:</b> ${data.yton}
  `;
}

/* ================= GECE HAYATI ================= */
function openNightlife(){
  showBox("nightlife");
  let html = `<b>üíã Genel Ev</b><br><br>`;
  brothelPeople.forEach(p=>{
    html += `
      <button onclick="buy(${p.id})">
        ${p.name} ‚Äì ${p.price} YTon<br>
        <small>${p.effect}</small>
      </button>
    `;
  });
  document.getElementById("nightlife").innerHTML = html;
}

/* ================= SATIN ALIM / HASTANE ================= */
async function buy(id){
  await sb.rpc("buy_item",{p_telegram_id:TELEGRAM_ID,p_item_id:id});
  showResult("Hizmet alƒ±ndƒ±");
  loadPlayer();
}
async function hospital(){
  await sb.rpc("hospital_heal",{p_telegram_id:TELEGRAM_ID});
  showResult("ƒ∞yile≈ütirildin");
  loadPlayer();
}

/* ================= INIT ================= */
loadPlayer();
</script>

</body>
</html>
